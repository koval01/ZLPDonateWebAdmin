{% load static %}

{# Template for generating a tape of records on the main page of the site. #}
{# Imagine that this code was not written by me. I don't really like him. #}

{% spaceless %}
    {% if typeload == 'newsession' and covid_stat_append %}
        {% if covid_ua.0 %}
            <div class="col-12 col-lg-12 padding-block-center-box">
                <div class="user box aos-init aos-animate" data-aos="fade-up">
                    {% with covid_block_ukraine=48|get_random_string %}
                    <div id="{{ covid_block_ukraine }}" style="float: left; ">
                        {% with script_id=64|get_random_string title=64|get_random_string %}
                        <label id="{{ title }}" class="username"></label><br>
                        <script id="{{ script_id }}">$("#{{ title }}").text("COVID-19 statistics in Ukraine");$("#{{ script_id }}").remove()</script>
                        {% endwith %}
                        {% with covid_block=48|get_random_string %}
                        <label id="{{ covid_block }}" class="city"><br/></label>
                            {% with script_id=64|get_random_string patients=12|get_random_string recovered=12|get_random_string lethal=12|get_random_string tested=12|get_random_string data_date=12|get_random_string %}
                            <script id="{{ script_id }}">let x{{ patients }}="{{ covid_ua.0 }} (+{{ covid_ua.1 }})";let x{{ recovered }}="{{ covid_ua.2 }}";let x{{ lethal }}="{{ covid_ua.3 }}";let x{{ tested }}="{{ covid_ua.4 }}";let x{{ data_date }}="{{ covid_ua.5 }}";$("#{{ covid_block }}").html("<br/><h6>😷Patients with Covid-19: <b>"+x{{ patients }}+"</b></h6><h6>❤️Recovered: <b>"+x{{ recovered }}+"</b></h6><h6>💔Lethal outcomes: <b>"+x{{ lethal }}+"</b></h6><h6>📝Tested: <b>"+x{{ tested }}+"</b></h6><br/><h6>📅<b>"+x{{ data_date }}+"</b></h6>");$("#{{ script_id }}").remove()</script>
                            {% endwith %}
                        {% endwith %}
                        <br/>
                        {% with script_id=64|get_random_string badge_block=64|get_random_string title_badge=12|get_random_string icon_badge=12|get_random_string %}
                        <div id="{{ badge_block }}" class="badge_block_info"></div>
                        <script id="{{ script_id }}">let x{{ title_badge }}="COVID-19&nbsp;";let x{{ icon_badge }}="fas fa-viruses";$("#{{ badge_block }}").html("<span style=\"margin:0.5em\">"+x{{ title_badge }}+"<i class=\""+x{{ icon_badge }}+"\"></i></span>");$("#{{ script_id }}").remove()</script>
                        {% endwith %}
                        {% with script_id=64|get_random_string telegram_share_link=48|get_random_string let_id=12|get_random_string %}
                        <a id="{{ telegram_share_link }}" href="" class="telegram_share select_disable_text" target="_blank" title="Share in Telegram">
                            <i class="fab fa-telegram-plane"></i>
                        Share </a>
                        <script id="{{ script_id }}">let x{{ let_id }}="{{ 16|get_random_string }}";$("#{{ telegram_share_link }}").attr("href", `tg://msg_url?url=${encodeURIComponent(window.location.href)}&text=${encodeURIComponent("\n"+$("#{{ covid_block_ukraine }}").children(".city").text().replaceAll('\n', '%0A'))}&id=`+x{{ let_id }});$("#{{ script_id }}").remove()</script>
                        {% endwith %}
                    </div>
                    {% endwith %}
                </div>
            </div>
        {% endif %}
        {% if covid_ru.0 %}
            <div class="col-12 col-lg-12 padding-block-center-box">
                <div class="user box aos-init aos-animate" data-aos="fade-up">
                    {% with covid_block_russia=48|get_random_string %}
                    <div id="{{ covid_block_russia }}" style="float: left; ">
                        {% with script_id=64|get_random_string title=64|get_random_string %}
                        <label id="{{ title }}" class="username"></label><br>
                        <script id="{{ script_id }}">$("#{{ title }}").text("COVID-19 statistics in Russia");$("#{{ script_id }}").remove()</script>
                        {% endwith %}
                        {% with covid_block=48|get_random_string %}
                        <label id="{{ covid_block }}" class="city"></label>
                            {% with script_id=64|get_random_string patients=12|get_random_string recovered=12|get_random_string lethal=12|get_random_string tested=12|get_random_string data_date=12|get_random_string %}
                            <script id="{{ script_id }}">let x{{ patients }}="{{ covid_ru.1 }} (+{{ covid_ru.2 }})";let x{{ recovered }}="{{ covid_ru.3 }}";let x{{ lethal }}="{{ covid_ru.4 }}";let x{{ tested }}="{{ covid_ru.0 }}";let x{{ data_date }}="{{ covid_ru.5 }}";$("#{{ covid_block }}").html("<br/><h6>😷Patients with Covid-19: <b>"+x{{ patients }}+"</b></h6><h6>❤️Recovered: <b>"+x{{ recovered }}+"</b></h6><h6>💔Lethal outcomes: <b>"+x{{ lethal }}+"</b></h6><h6>📝Tested: <b>"+x{{ tested }}+"</b></h6><br/><h6>📅<b>"+x{{ data_date }}+"</b></h6>");$("#{{ script_id }}").remove()</script>
                            {% endwith %}
                        {% endwith %}
                        <br/>
                        {% with script_id=64|get_random_string badge_block=64|get_random_string title_badge=12|get_random_string icon_badge=12|get_random_string %}
                        <div id="{{ badge_block }}" class="badge_block_info"></div>
                        <script id="{{ script_id }}">let x{{ title_badge }}="COVID-19&nbsp;";let x{{ icon_badge }}="fas fa-viruses";$("#{{ badge_block }}").html("<span style=\"margin:0.5em\">"+x{{ title_badge }}+"<i class=\""+x{{ icon_badge }}+"\"></i></span>");$("#{{ script_id }}").remove()</script>
                        {% endwith %}
                        {% with script_id=64|get_random_string telegram_share_link=48|get_random_string let_id=12|get_random_string %}
                        <a id="{{ telegram_share_link }}" href="" class="telegram_share select_disable_text" target="_blank" title="Share in Telegram">
                            <i class="fab fa-telegram-plane"></i>
                        Share </a>
                        <script id="{{ script_id }}">let x{{ let_id }}="{{ 16|get_random_string }}";$("#{{ telegram_share_link }}").attr("href", `tg://msg_url?url=${encodeURIComponent(window.location.href)}&text=${encodeURIComponent("\n"+$("#{{ covid_block_russia }}").children(".city").text().replaceAll('\n', '%0A'))}&id=`+x{{ let_id }});$("#{{ script_id }}").remove()</script>
                        {% endwith %}
                    </div>
                    {% endwith %}
                </div>
            </div>
        {% endif %}
    {% endif %}

    {% if typeload == "newsession" %}
        {% if c_result %}
            <div class="col-12 col-lg-12 padding-block-center-box">
                <div class="user box aos-init aos-animate" data-aos="fade-up">
                    <div style="float: left;">
                        <label class="city">
                            <i>
                                {{ c_input }}&nbsp;=&nbsp;<b style="text-decoration: underline;">{{ c_result }}</b>
                            </i>
                        </label>
                        <br/>
                        {% with script_id=64|get_random_string badge_block=64|get_random_string title_badge=12|get_random_string icon_badge=12|get_random_string %}
                        <div id="{{ badge_block }}" class="badge_block_info"></div>
                        <script id="{{ script_id }}">let x{{ title_badge }}="Calculator&nbsp;";let x{{ icon_badge }}="fas fa-calculator";$("#{{ badge_block }}").html("<span style=\"margin:0.5em\">"+x{{ title_badge }}+"<i class=\""+x{{ icon_badge }}+"\"></i></span>");$("#{{ script_id }}").remove()</script>
                        {% endwith %}
                    </div>
                </div>
            </div>
        {% endif %}
        {% if translate_result %}
            <div class="col-12 col-lg-12 padding-block-center-box">
                <div class="user box aos-init aos-animate" data-aos="fade-up">
                    <div style="float: left;">
                        <label class="city">
                            <i>
                                {{ search }}
                            </i>
                            <br/><br/>
                            <b>
                                {{ translate_result }}
                            </b>
                        </label>
                        <br/>
                        {% with script_id=64|get_random_string badge_block=64|get_random_string title_badge=12|get_random_string icon_badge=12|get_random_string %}
                        <div id="{{ badge_block }}" class="badge_block_info"></div>
                        <script id="{{ script_id }}">let x{{ title_badge }}="Translator&nbsp;";let x{{ icon_badge }}="fas fa-language";$("#{{ badge_block }}").html("<span style=\"margin:0.5em\">"+x{{ title_badge }}+"<i class=\""+x{{ icon_badge }}+"\"></i></span>");$("#{{ script_id }}").remove()</script>
                        {% endwith %}
                    </div>
                </div>
            </div>
        {% endif %}
        {% if news_search_in_str %}
            <!-- News block place -->
        {% endif %}
        {% if weather %}
            <div class="col-12 col-lg-12 padding-block-center-box" style="margin: auto;">
                <div class="user box aos-init aos-animate" data-aos="fade-up">
                    <div style="float: left;">
                        <div class="col-xs-12">
                            <div class="weather-panel col-xs-12 col-sm-12"
                            style="color: #efeff1;">
                                <div class="col-xs-6">
                                    <h2>{{ weather.now_weather.name }}<br>
                                        <small style="color: inherit;font-size: 50%;">
                                            {% now "l, j E" %}
                                        </small>
                                    </h2>
                                    <p class="h3">
                                        {{ weather.now_weather.weather.0.icon|get_weather_ico|safe }}
                                        &nbsp;{{ weather.now_weather.weather.0.description|capfirst }}
                                    </p>
                                    <p>
                                        <i class="fas fa-temperature-low"></i>
                                        Feels like {{ weather.now_weather.main.feels_like|floatformat:"0" }}°
                                    </p>
                                    <p>
                                        <i class="fas fa-wind"></i>
                                        {{ weather.now_weather.wind.speed }} m\sec
                                    </p>
                                </div>
                                <div class="col-xs-6 text-center">
                                    <div class="h1 temperature">
                                        <span style="font-size:2em">{{ weather.now_weather.main.temp|floatformat:"0" }}°</span>
                                        <br>
                                        {% if weather.now_weather.main.temp_min|floatformat:"0" != weather.now_weather.main.temp_max|floatformat:"0" %}
                                            <small style="color:inherit;font-size:50%">
                                                From {{ weather.now_weather.main.temp_min|floatformat:"0" }}° to {{ weather.now_weather.main.temp_max|floatformat:"0" }}°
                                            </small>
                                        {% endif %}
                                    </div>
                                </div>
                                <div class="col-xs-12">
                                    <ul class="list-inline row forecast">
                                        <li id="{{ 24|get_random_string }}" style="border-top:1px solid #fff" class="col-xs-4 col-sm-2 text-center">
                                            <h3 class="h5">{% now "D, j E" %}</h3>
                                            <p>
                                                {{ weather.now_weather.weather.0.icon|get_weather_ico|safe }}
                                                <br>
                                                {{ weather.now_weather.main.temp|floatformat:"0" }}°
                                            </p>
                                        </li>
                                        {% for weather_el in weather.future_weather %}
                                            <li style="border-top: 1px solid #fff;" class="col-xs-4 col-sm-2 text-center">
                                                <h3 class="h5">{{ forloop.counter|add_days_by_timestamp|date:"D, j E" }}</h3>
                                                <p>
                                                    {{ weather_el.weather.0.icon|get_weather_ico|safe }}
                                                    <br>
                                                    {{ weather_el.main.temp|floatformat:"0" }}°
                                                </p>
                                            </li>
                                        {% endfor %}
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        {% endif %}
    {% endif %}
    {% if namaz_data %}
        {% for el in namaz_data %}
            <div class="col-12 col-lg-12 padding-block-center-box">
                <div class="user box aos-init aos-animate" data-aos="fade-up">
                    <div style="float: left;">
                        <label class="username">Muslim prayers for {{ el.time }}, {{ el.hijri_day }} {{ el.hijri_month }} {{ el.hijri_year }}</label><br>
                        <label class="city">
                            <p>
                                <br/>
                            {% for i in el.timings %}
                                {{ i }}<br/>
                            {% endfor %}
                                <br/>
                                Calculation Method: Islamic World League
                                <br/><br/>
                                Time zone: {{ el.timezone }}
                                <br/>
                                Updated: {{ el.update_time }} (Server time)
                            </p>
                        </label>
                        <br/>
                        {% with script_id=64|get_random_string badge_block=64|get_random_string title_badge=12|get_random_string icon_badge=12|get_random_string %}
                        <div id="{{ badge_block }}" class="badge_block_info"></div>
                        <script id="{{ script_id }}">let x{{ title_badge }}="Namaz&nbsp;";let x{{ icon_badge }}="fas fa-quran";$("#{{ badge_block }}").html("<span style=\"margin:0.5em\">"+x{{ title_badge }}+"<i class=\""+x{{ icon_badge }}+"\"></i></span>");$("#{{ script_id }}").remove()</script>
                        {% endwith %}
                    </div>
                </div>
            </div>
        {% endfor %}
    {% endif %}

    {% if videos %}
        <!-- Videos block place -->
    {% else %}
        {% if not search_index %}
            {% if check_bot_request_search %}
                <div class="col-12 col-lg-12 padding-block-center-box">
                    <div class="user box aos-init aos-animate" data-aos="fade-up">
                        <div style="float: left;">
                            <label class="username">AWARE bot in Telegram</label><br>
                            <label class="city">
                                Convenient search engine directly in Telegram. To go to the bot - click on its alias <a href="https://t.me/AwareSearchBot">@AwareSearchBot</a>.
                            </label>
                            <br/>
                            {% with script_id=64|get_random_string badge_block=64|get_random_string title_badge=12|get_random_string icon_badge=12|get_random_string %}
                            <div id="{{ badge_block }}" class="badge_block_info"></div>
                            <script id="{{ script_id }}">let x{{ title_badge }}="Telegram&nbsp;";let x{{ icon_badge }}="fab fa-telegram-plane";$("#{{ badge_block }}").html("<span style=\"margin:0.5em\">"+x{{ title_badge }}+"<i class=\""+x{{ icon_badge }}+"\"></i></span>");$("#{{ script_id }}").remove()</script>
                            {% endwith %}
                        </div>
                    </div>
                </div>
            {% endif %}
        {% endif %}
        {% for el in data %}
            {% if forloop.counter == 1 and not search_index and images_search %}
                <div class="col-12 col-lg-12 padding-block-center-box" style="width:100%">
                    <div class="user box aos-init aos-animate images_search_layer_aware" data-aos="fade-up">
                        <div style="float: left;">
                            <label class="city images_search_layer_aware_edit">
                                <div class="photos-slider-aware select_disable_text">
                                    {% for el_images in images_search %}
                                        <div>
                                            <div>
                                                <a href="{{ el_images.image.contextLink }}" target="_blank">
                                                    <img onerror="imgError(this);" style="border-radius: 0.5em;margin-bottom: 5px;width: 50%;margin-right: 5px;-webkit-appearance: none;max-height:200px;max-width: 140px;padding: 0;box-shadow: 0px 3px 8px 0px rgb(0 0 0 / 40%)"
                                                    src="{% url 'imageproxy' %}?data={{ el_images.image.thumbnailLink|link_encrypt_img }}&v=1&token={{ token_image_proxy }}&sign={{ user_address_original|sign_address_encrypt }}" alt="Preview image">
                                                </a>
                                            </div>
                                            <div style="background: #313131;padding: 3px;border-radius: 0.5em">
                                                <b style="color: #efeff1;margin: 0px;">
                                                    <a href="{{ el_images.image.contextLink }}" target="_blank">
                                                        {% if el_images.title|length > 3 %}
                                                            {{ el_images.htmlTitle|safe }}
                                                        {% else %}
                                                            {{ search }}
                                                        {% endif %}
                                                    </a>
                                                </b>
                                            </div>
                                        </div>
                                    {% endfor %}
                                </div>
                            </label>
                            <div style="margin-top: 1em;transition: margin-top 1s, margin-bottom 1s;margin-bottom: -2em;" class="hint_text_images_scroll_aware">
                                <b style="color: #808080;font-size: 0.7em;">
                                    To scroll through images, drag them from right to left
                                </b>
                            </div>
                            <br/>
                            {% with script_id=64|get_random_string badge_block=64|get_random_string title_badge=12|get_random_string icon_badge=12|get_random_string %}
                            <div id="{{ badge_block }}" class="badge_block_info"></div>
                            <script id="{{ script_id }}">let x{{ title_badge }}="Images&nbsp;";let x{{ icon_badge }}="far fa-image";$("#{{ badge_block }}").html("<span style=\"margin:0.5em\">"+x{{ title_badge }}+"<i class=\""+x{{ icon_badge }}+"\"></i></span>");$("#{{ script_id }}").remove()</script>
                            {% endwith %}
                        </div>
                    </div>
                </div>
                <script>var slider=tns({container:".photos-slider-aware",items:2,speed:500,loop:!1,autoHeight:!0,mouseDrag:!0,autoWidth:!1,swipeAngle:20,preventScrollOnTouch:!1,lazyload:!1,controls:!1,nav:!1,edgePadding:0,responsive:{320:{gutter:5,items:1},640:{gutter:8,items:2},700:{gutter:12},900:{items:3}}});$(document).ready(function(){function e(){$(".images_search_layer_aware_edit").css("max-width",document.getElementsByClassName("images_search_layer_aware")[0].clientWidth-40)}$(window).resize(function(){e()}),setInterval(e,10),setTimeout(function(){$(".hint_text_images_scroll_aware").css({visibility:"hidden","margin-bottom":"-3em"})},5e3)})</script>
            {% endif %}
            {% if not additions and news_append %}
                {% if el.0.0 %}
                    <div class="col-12 col-lg-12 padding-block-center-box">
                        <div class="user box aos-init aos-animate" data-aos="fade-up">
                            <div style="float: left;">
                                <label class="username">{{ el.0.0 }}</label><br>
                                <label class="city">
                                    {# paste news image or text if this is a mobile device #}
                                    {% if mobile == '1' %}
                                        <img src="{% url 'image_generate_api' %}?text={{ el.0.1 }}&author={{ el.0.2 }}&sign={{ user_address_original|sign_address_encrypt }}&token={{ token_image_proxy }}"
                                                 class="photohub_item" onerror="imgError(this);" style="width:100%;margin-top: 3%;" alt="News block cover">
                                    {% else %}
                                        <br/>
                                        <i>
                                            {{ el.0.1 }}
                                        </i>
                                    {% endif %}
                                    <br/><br/>
                                    <b>
                                        A source - <a href="{{ el.0.4 }}" target="_blank">{{ el.0.2 }}</a>
                                    </b>
                                    <br>
                                    <i>
                                        <u>Published at {{ el.0.3 }} (UTC)</u>
                                    </i>
                                </label>
                            </div>
                        </div>
                    </div>
                {% endif %}
            {% endif %}
            {% if not search_api_full_dict.error %}
                {% if el.1.title %}
                    <div class="col-12 col-lg-12 padding-block-center-box">
                        <div class="user box aos-init aos-animate" data-aos="fade-up">
                            <div style="float: left;">
                                {% with script_id=64|get_random_string title_el=64|get_random_string title_link=12|get_random_string title_text=12|get_random_string %}
                                <label id="{{ title_el }}" class="username" style="margin-top: -0.5em;"></label><br/>
                                <script id="{{ script_id }}">let x{{ title_text }}="{{ el.1.title }}";let x{{ title_link }}="{{ el.1.link }}";$("#{{ title_el }}").html("<a target=\"_blank\" href=\""+x{{ title_link }}+"\" style=\"word-break: break-word\">"+x{{ title_text }}+"</a>");$("#{{ script_id }}").remove()</script>
                                {% endwith %}
                                <label class="city">
                                    {% if el.1.thumb and not el.1.youtube_id %}
                                        <a target="_blank" href="{{ el.1.link }}">
                                            <img
                                                    src="{% url 'imageproxy' %}?data={{ el.1.thumb|link_encrypt_img }}&v=1&token={{ token_image_proxy }}&sign={{ user_address_original|sign_address_encrypt }}"
                                                    onerror="imgError(this);"
                                                    style="margin-top: 1%;max-width: 32%;min-width: 25%;margin-right: 0.9em;height: auto;-webkit-appearance: none;border-radius: 0.5em;padding: 0;text-align: left;padding-bottom: 1px;box-shadow: 0 4px 15px 0 rgb(0 0 0 / 40%);"
                                                    alt="Preview image"
                                            >
                                        </a>
                                    {% elif el.1.youtube_id %}
                                        <div class="view-container-youtube-video-aware">
                                            <img
                                                    src="{% url 'imageproxy' %}?data={{ el.1.thumb|link_encrypt_img }}&v=1&token={{ token_image_proxy }}&sign={{ user_address_original|sign_address_encrypt }}"
                                                    onerror="imgError(this);"
                                                    style="margin-top:1%;max-width:32%;min-width:25%;margin-right:0.9em;height:auto;-webkit-appearance:none;border-radius:0.5em;padding:0;text-align:left;padding-bottom:1px;box-shadow: 0 4px 15px 0 rgb(0 0 0 / 40%)"
                                                    class="video_youtube_preview_image_aware"
                                                    alt="Preview image"
                                                    data-youtube-id="{{ el.1.youtube_id }}">
                                        </div>
                                    {% endif %}
                                    <p>
                                        {{ el.1.displayLink }}
                                    </p>
                                    {% with script_id=64|get_random_string desc_el=64|get_random_string title_link=12|get_random_string title_text=12|get_random_string %}
                                    <description-aware id="{{ desc_el }}"></description-aware>
                                    <script id="{{ script_id }}">let x{{ desc_el }}='{{ el.1.snippet|safe }}';$("#{{ desc_el }}").html(x{{ desc_el }});$("#{{ script_id }}").remove()</script>
                                    {% endwith %}
                                </label>
                                {% if el.1.youtube_id %}
                                    <div
                                            style="margin-top: 1em;transition: margin-top 1s;"
                                            class="hint_text_video_play_yt"
                                    >
                                        <b style="color: #808080;font-size: 0.7em;">
                                            To view the video - click on the picture
                                        </b>
                                    </div>
                                    <div
                                            class="youtube_video_info_div"
                                            style="
                                                background: #fff;
                                                border-radius: 0.5em;
                                                font-weight: 600;
                                                font-size: 0.9em;
                                                margin-top: 1em;
                                                display: inline-block;
                                            "
                                            title="To view the video - click on the picture"
                                    >
                                        <span style="
                                            margin: 0.5em;
                                        ">YouTube&nbsp;
                                            <i class="fab fa-youtube"></i>
                                            <i class="spinner-border youtube_video_load_wait_aware" style="
                                                width: 20px !important;
                                                height: 20px !important;
                                                display: none;
                                                margin-left: 5px;
                                                position: relative;
                                                top: 0.1em;
                                            "></i>
                                        </span>
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                {% endif %}
            {% elif search_api_full_dict.error and forloop.counter == 1 and not namaz_data %}
                <div class="col-12 col-lg-12 padding-block-center-box">
                    <div class="user box aos-init aos-animate" data-aos="fade-up">
                        <div class="box_aware_error">
                            <div class="box_aware_error__ghost">
                                <div class="symbol"></div>
                                <div class="symbol"></div>
                                <div class="symbol"></div>
                                <div class="symbol"></div>
                                <div class="symbol"></div>
                                <div class="symbol"></div>
                                <div class="box_aware_error__ghost-container">
                                    <div class="box_aware_error__ghost-eyes">
                                        <div class="box_aware_error__eye-left"></div>
                                        <div class="box_aware_error__eye-right"></div>
                                    </div>
                                    <div class="box_aware_error__ghost-bottom">
                                        <div></div>
                                        <div></div>
                                        <div></div>
                                        <div></div>
                                        <div></div>
                                    </div>
                                </div>
                                <div class="box_aware_error__ghost-shadow"></div>
                            </div>
                            <div class="box_aware_error__description">
                                <div class="box_aware_error__description-container">
                                    <div class="box_aware_error__description-title">
                                        Oh!
                                    </div>
                                    <div class="box_aware_error__description-text">
                                        It looks like your search query contains a word that the administrator has banned. Talk to
                                        <a href="https://t.me/Jomahmadov2002">Administrator</a> if you think this is a mistake.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            {% endif %}
        {% endfor %}
    {% endif %}
{% endspaceless %}
