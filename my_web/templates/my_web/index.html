{% extends 'my_web/base.html' %}

{% block title %}
AWARE - Поиск
{% endblock %}

{% block title_header %}
AWARE
{% endblock %}

{% block og_desc %}
Удобная и красивая поисковая система
{% endblock %}

{% block twitter_desc %}
Удобная и красивая поисковая система
{% endblock %}

{% block public_re %}
{{ token_re }}
{% endblock %}

{% block content %}
{% load static %}
    <div style="display: block;margin-left: auto;margin-right: auto;border-radius: 20%;">
        <div class="advertise-aware-block">
            <!-- Outdated/Disabled now block -->
        </div>
        <div class="search-aware-block-global">
            <div class="wrapper" style="margin-bottom: 5%;">
                <div class="search-input" style="z-index: 106;">
                    <a href="" target="_blank" hidden></a>
                    <input type="text" maxlength="800" class="search-input-aware" size="100" style="transition: padding 0.5s;" placeholder="{{ search_template }}">
                    <div class="autocom-box disable-track-aware">
                    </div>
                    <div class="load-more-end-butt icon">
                        <i class="spinner-border spinner_search_load_aware" style="visibility: hidden;"></i>
                        <i class="fas fa-search icon_search_load_aware_one" style="visibility: hidden;" title="Поиск"></i>
                    </div>
                    <div class="clear_aware_search_string" style="transition: margin-right 0.6s;margin-right: 40px;top: 0.8em;position: absolute;right: 0px;text-align: center;line-height: 55px;font-size: 20px;color: #202124;cursor: pointer;">
                        <i class="fas fa-times" title="Очистить строку"></i>
                    </div>
                </div>
            </div>
        </div>
        <div class="row-posts-end-ad">
            <!-- Reserved block -->
        </div>
        <div class="row-posts-end">
            {% if advertise %}
                <div class="col-12 col-lg-12 padding-block-center-box">
                    <div class="user box aos-init aos-animate" data-aos="fade-up">
                        <div style="float: left;">
                            <label class="city" style="font-size: calc(14px + (18 - 14) * ( (100vw - 480px) / ( 1024 - 480) ));">
                                {{ advertise.i_text|safe }}
                            </label>
                            <br/>
                            <div style="
                                background: #fff;
                                border-radius: 0.5em;
                                font-weight: 600;
                                font-size: 0.9em;
                                margin-top: 1em;
                                display: inline-block;
                            ">
                                <span style="
                                    margin: 0.5em;
                                ">Реклама&nbsp;
                                    <i class="fas fa-ad"></i>
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
            {% endif %}
            {% if not news_rand %}
                {% if add_.text %}
                    {% if r_type %}
                        <div class="col-12 col-lg-12 padding-block-center-box">
                            <div class="user box aos-init aos-animate" data-aos="fade-up">
                                <div style="float: left;">
                                    <label class="username">Случайная цитата</label><br>
                                    <label class="city"><i>„{{ add_.text }}“</i><br><br><b>{{ add_.author }}</b></label><br>
                                </div>
                            </div>
                        </div>
                    {% else %}
                        <div class="col-12 col-lg-12 padding-block-center-box">
                            <div class="user box aos-init aos-animate" data-aos="fade-up">
                                <div style="float: left;">
                                    <label class="username">Случайный факт</label><br>
                                    <label class="city"><i>{{ add_.text }}</i><br></label><br><br>
                                </div>
                            </div>
                        </div>
                    {% endif %}
                {% endif %}
            {% else %}
                <div class="col-12 col-lg-12 padding-block-center-box">
                    <div class="user box aos-init aos-animate" data-aos="fade-up">
                        <div style="float: left;">
                            <label class="username aware_news_index_page_title">{{ add_.0 }}</label><br>
                            <label class="city">
                                <u
                                        style="color: #8AB4F8;font-weight: 600;"
                                        class="news_search_button_aware_index_block"
                                >Искать новость</u>
                                <br/><br/>
                                <i>
                                    {{ add_.1 }}
                                </i>
                                <br/><br/>
                                <b>
                                    Источник - <a href="{{ add_.4 }}" target="_blank">{{ add_.2 }}</a>
                                </b>
                                <br>
                                <i>
                                    <u>Опубликовано {{ add_.3 }} (UTC)</u>
                                </i>
                            </label>
                        </div>
                    </div>
                </div>
            {% endif %}
        </div>
        <div style="margin: auto;">
            <p class="no-more-results-text" style="color: #828282;font-size: 14px;visibility: hidden;text-align: center;">Больше результатов нет</p>
        </div>
        <button style="margin:0 auto;display:block;background-color:#121213;visibility: hidden;margin-bottom: 5%;" class="btn btn-dark load-more-end-butt-search-array">Загрузить еще&nbsp;<span class="spinner-border spinner-border-sm" aria-hidden="true"></span></button>
    </div>
{% endblock %}

{% block js_module %}
    {% csrf_token %}
    <script type="text/javascript">
        function imgError(e){return e.onerror="",e.src="{% static 'my_web/images/background.png' %}",!0}function edit_query_string_q(e){var a=new URLSearchParams(window.location.search);a.set("q",e),history.replaceState(null,null,"?"+a.toString())}function search_title_set(e){document.title="AWARE - "+e}function throttle(e,a){let t,i,o=!1;return function n(){if(o)return t=arguments,void(i=this);e.apply(this,arguments),o=!0,setTimeout(function(){o=!1,t&&(n.apply(i,t),t=i=null)},a)}}function getParameterByName(e,a=window.location.href){try{e=e.replace(/[\[\]]/g,"\\$&");var t=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(a);return t?t[2]?decodeURIComponent(t[2].replace(/\+/g," ")):"":null}catch{alert("Ошибка анализа адресной строки.")}}function etdd(){let e=!1;var a;return a=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))&&(e=!0),e}function mob(){return etdd()?0:1}var search_index=0,updated_search_text="",comment_spin_global="",timerId_global="",timer_clear_update="",timer_clear_is_active=!0,get_ad_active_now=!1,error_block_space_design='<div class="col-12 col-lg-12 padding-block-center-box"><div class="user box aos-init aos-animate" data-aos="fade-up"><div class="box_aware_error"><div class="box_aware_error__ghost"><div class="symbol"></div> <div class="symbol"></div> <div class="symbol"></div><div class="symbol"></div><div class="symbol"></div><div class="symbol"></div><div class="box_aware_error__ghost-container"><div class="box_aware_error__ghost-eyes"><div class="box_aware_error__eye-left"></div><div class="box_aware_error__eye-right"></div></div><div class="box_aware_error__ghost-bottom"><div></div><div></div><div></div><div></div><div></div></div></div><div class="box_aware_error__ghost-shadow"></div></div><div class="box_aware_error__description"><div class="box_aware_error__description-container"><div class="box_aware_error__description-title">Ой!</div><div class="box_aware_error__description-text">Мы не смогли ничего найти по вашему запросу... Повторите попытку, или переформулируйте вопрос.</div></div></div></div></div></div>',pageX=$(document).width(),pageY=$(document).height(),mouseY=0,mouseX=0;function load_ajax_end_page(e,a){const t=$(".no-more-results-text"),i=$(".load-more-end-butt"),o=i.find("span"),n=$(".load-more-end-butt-search-array"),r=n.find("span");var s=jQuery("[name=csrfmiddlewaretoken]").val(),c=e;grecaptcha.ready(function(){grecaptcha.execute("{{ token_re }}",{action:"submit"}).then(function(l){var d=l;$.ajax({url:"{% url 'load_more' %}",type:"POST",data:{csrfmiddlewaretoken:s,validtoken:"{{ token_valid }}",typeload:a,additions:0,news:0,gr_token:d,covid_stat:0,search:e,mobile:mob()},beforeSend:function(){$(".clear_aware_search_string").css("margin-right","2.4em"),$(".search-input-aware").css("padding","0 68px 0 20px"),t.css("visibility","hidden"),i.attr("disabled",!0),o.addClass("d-inline-block"),AOS.init(),get_ad("con"),error_search_no_text("ok"),comment=document.createComment($(".icon_search_load_aware_one").get(0).outerHTML),$(".icon_search_load_aware_one").replaceWith(comment),i.css("top","-5px"),i.css("right","10px"),$(".spinner_search_load_aware").replaceWith(comment_spin_global),$(comment_spin_global).replaceWith(comment_spin_global.nodeValue)},success:function(e){$(".clear_aware_search_string").css("margin-right","1.9em"),$(".search-input-aware").css("padding","0 60px 0 20px"),updated_search_text=c,$(comment).replaceWith(comment.nodeValue),search_title_set(c),edit_query_string_q(c),i.removeAttr("style"),$(".spinner_search_load_aware").replaceWith(comment_spin_global),n.css("visibility","visible"),e.replace(/[^+\w]/g,"").length<10&&n.css("visibility","hidden"),r.css("visibility","hidden"),r.removeClass("d-inline-block"),document.querySelector(".search-input").classList.remove("active"),$(".float_bg").css("display","none"),AOS.init(),"newsession"==a&&($(".row-posts-end").empty(),search_index=21),i.attr("disabled",!1),o.removeClass("d-inline-block"),"Ошибка валидации!"==e?alert("Ошибка. Не удалось подтвердить запрос. Перезагрузите страницу."):$(".row-posts-end").append(e),AOS.init(),$(document).ready(function(){$('[data-toggle="tooltip"]').tooltip()}),e.length<10?(i.removeAttr("style"),$(".spinner_search_load_aware").replaceWith(comment_spin_global),$(".row-posts-end").empty(),$(comment).replaceWith(comment.nodeValue),$(".row-posts-end").append(error_block_space_design),i.attr("disabled",!1),o.removeClass("d-inline-block")):$(".wrapper").css("margin","15px auto"),setTimeout(function(){AOS.init()},1200)},error:function(){$(".clear_aware_search_string").css("margin-right","1.9em"),$(".search-input-aware").css("padding","0 60px 0 20px"),i.removeAttr("style"),$(".spinner_search_load_aware").replaceWith(comment_spin_global),$(".row-posts-end").empty(),$(comment).replaceWith(comment.nodeValue),$(".row-posts-end").append(error_block_space_design),i.attr("disabled",!1),o.removeClass("d-inline-block")}})})})}function load_continue_ajax_end_page(e,a){const t=$(".no-more-results-text"),i=$(".load-more-end-butt-search-array"),o=i.find("span");var n=jQuery("[name=csrfmiddlewaretoken]").val();grecaptcha.ready(function(){grecaptcha.execute("{{ token_re }}",{action:"submit"}).then(function(r){var s=r;$.ajax({url:"{% url 'load_more' %}",type:"POST",data:{csrfmiddlewaretoken:n,validtoken:"{{ token_valid }}",typeload:a,additions:0,news:0,gr_token:s,covid_stat:0,search:e,mobile:mob(),search_index_:search_index},beforeSend:function(){t.css("visibility","hidden"),i.attr("disabled",!0),o.addClass("d-inline-block"),error_search_no_text("ok"),o.css("visibility","visible"),AOS.init()},success:function(e){o.css("visibility","hidden"),(search_index+=10)>100&&(i.css("visibility","hidden"),t.css("visibility","visible")),i.attr("disabled",!1),o.removeClass("d-inline-block"),"Ошибка валидации!"==e?alert("Ошибка. Не удалось подтвердить запрос. Перезагрузите страницу."):$(".row-posts-end").append(e),AOS.init(),$(document).ready(function(){$('[data-toggle="tooltip"]').tooltip()}),e.length<10&&(i.css("visibility","hidden"),i.attr("disabled",!1),o.css("visibility","hidden"),o.removeClass("d-inline-block"),t.css("visibility","visible"))},error:function(){i.css("visibility","hidden"),i.attr("disabled",!1),o.css("visibility","hidden"),o.removeClass("d-inline-block"),t.css("visibility","visible")}})})})}function onMenuClicked(){$(".menu_box").is(":hidden")?($(".menu_box").show(),$(".float_bg").show(),$(".search-input").attr("disabled",!1),$(".search-input").css("z-index",1)):($(".menu_box").hide(),$(".float_bg").hide(),$(".search-input").css("z-index",106),$(".search-input").attr("disabled",!0))}function get_suggestions(){$.ajax({url:"{% url 'search_suggestions_get' %}",type:"GET",data:{q:$(".search-input-aware").val()},success:function(e){$(".autocom-box").empty(),$(".autocom-box").append(e.data)},async:!0,timeout:3e3})}function run_remove_active(){document.querySelector(".search-input").classList.remove("active"),$(".float_bg").css("display","none"),AOS.init(),get_suggestions($(".search-input-aware").val())}function error_search_no_text(e){"error"==e?(clearInterval(timerId_global),clearInterval(timer_clear_update),$(".search-input-aware").attr("placeholder","Это поле не может быть пустым")):$(".search-input-aware").attr("placeholder","{{ search_template }}")}function append_ad_block(e){var a='<div class="col-12 col-lg-12 padding-block-center-box"><div class="user box aos-init aos-animate"     data-aos="fade-up"><div style="float: left;"><label class="city" style="font-size: calc(14px + (18 - 14) * ( (100vw - 480px) / ( 1024 - 480) ));"    >'+String(e.text).replace("\n","<br>")+"</label></div></div></div>";$(".row-posts-end-ad").empty(),$(".advertise-aware-block").append(a),AOS.init()}function prepend_ad_block_to_search_results(e){var a='<div class="col-12 col-lg-12 padding-block-center-box"><div class="user box aos-init aos-animate"     data-aos="fade-up"><div style="float: left;"><label class="city" style="font-size: calc(14px + (18 - 14) * ( (100vw - 480px) / ( 1024 - 480) ));    ">'+String(e.text).replace("\n","<br>")+"</label></div></div></div>";$(".advertise-aware-block").empty(),$(".row-posts-end-ad").empty(),$(".row-posts-end-ad").prepend(a),AOS.init()}function get_ad(e){get_ad_active_now&&"con"==e&&grecaptcha.ready(function(){grecaptcha.execute("{{ token_re }}",{action:"submit"}).then(function(a){$.ajax({url:"{% url 'get_ad' %}",type:"GET",data:{key:a,lang:"ru"},success:function(a){$(".autocom-box").empty(),"con"==e?prepend_ad_block_to_search_results(a):console.log("Advertise loading error!")},async:!0,timeout:5e3})})})}$(document).mousemove(function(e){mouseY=e.pageY,yAxis=(pageY/2-mouseY)/pageY*300,mouseX=e.pageX/-pageX,xAxis=100*-mouseX-100,$(".box_aware_error__ghost-eyes").css({transform:"translate("+xAxis+"%,-"+yAxis+"%)"})}),$(".search-input-aware").on("keyup",function(e){if("Enter"===e.key||13===e.keyCode){var a=$(".search-input-aware").val();0==a.length?error_search_no_text("error"):load_ajax_end_page(a,"newsession")}}),$(".search-input-aware").on("input",function(){var e=$(".search-input-aware").val();if(0==e.length)setTimeout(run_remove_active,200);else{document.querySelector(".search-input").classList.add("active"),$(".search-input").css("z-index",106),$(".float_bg").removeAttr("style"),AOS.init(),throttle(get_suggestions,150)(e)}}),$(".search-input-aware").on("focus",function(){$(".search-input-aware").val().length>0&&(document.querySelector(".search-input").classList.add("active"),$(".search-input").css("z-index",106),$(".float_bg").removeAttr("style"),AOS.init())}),$(".search-input-aware").on("focusout",function(){setTimeout(function(){document.querySelector(".search-input").classList.remove("active"),$(".float_bg").css("display","none"),AOS.init()},200)}),$(".load-more-end-butt").on("click",function(){var e=$(".search-input-aware").val();0==e.length?error_search_no_text("error"):load_ajax_end_page(e,"newsession")}),$(".clear_aware_search_string").on("click",function(){var e=$(".search-input-aware").val();if(console.log("Text: "+e),e.length>0){run_remove_active(),$(".search-input-aware").val("");let e=0;let a=setInterval(()=>(e+=1,console.log(e),void $(".search-input-aware").attr("placeholder","Ок...".slice(0,e))),150);timerId_global=a,setTimeout(()=>{clearInterval(a),e=0},1400),timer_clear_is_active&&(timer_clear_update=setTimeout(function(){$(".search-input-aware").attr("placeholder","{{ search_template }}")},1500))}}),$(".autocom-box").on("click",".aware-recommendation-search-el",function(e){var a=$(this).attr("id"),t=$("#"+a).text();$(".search-input-aware").val(t),load_ajax_end_page(t,"newsession")}),$(".load-more-end-butt-search-array").on("click",function(){var e=updated_search_text;0==e.length?error_search_no_text("error"):load_continue_ajax_end_page(e,search_index)}),$(".news_search_button_aware_index_block").on("click",function(){var e=$(".aware_news_index_page_title").text();e.length>0?($(".search-input-aware").val(e),load_ajax_end_page(e,"newsession")):console.log("News search error!")}),$(window).scroll(function(){$(window).scrollTop()==$(document).height()-$(window).height()&&setTimeout(function(){$(window).scrollTop(),$(document).height(),$(window).height()},150)}),AOS.init(),$(document).ready(function(){$('[data-toggle="tooltip"]').tooltip();var e=getParameterByName("q");e||get_ad("new"),my_element_jq=$(".spinner_search_load_aware"),elemnt_icon_aware=$(".icon_search_load_aware_one"),my_element_jq.removeAttr("style"),elemnt_icon_aware.removeAttr("style"),comment_spin_global=document.createComment(my_element_jq.get(0).outerHTML),my_element_jq.replaceWith(comment_spin_global),e&&($(".wrapper").css("margin","15px auto"),$("input.search-input-aware").val(e),load_ajax_end_page(e,"newsession"))}),$("a.scroll-to").on("click",function(e){e.preventDefault();var a=$(this).attr("href");$("html, body").stop().animate({scrollTop:$(a).offset().top-60},900)}),$(window).scroll(function(){home_button=document.getElementById("h_butt"),1e3<$(window).scrollTop()?home_button.style.visibility="visible":home_button.style.visibility="hidden"}),$(document).on("click",function(e){$(e.target).hasClass("float_bg")&&($(".menu_box").hide(),$(".float_bg").hide())});
    </script>
{% endblock %}

